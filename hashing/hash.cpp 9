#include <iostream>
using namespace std;

const int TABLE_SIZE = 10;

// Node structure for separate chaining
struct Node {
    int residentID;      // Key
    int flatNumber;      // Value
    Node* next;

    Node(int id, int flat) {
        residentID = id;
        flatNumber = flat;
        next = NULL;
    }
};

class ApartmentHashTable {
private:
    Node* table[TABLE_SIZE];

    // Hash function
    int hashFunction(int key) {
        return key % TABLE_SIZE;
    }

public:
    ApartmentHashTable() {
        for (int i = 0; i < TABLE_SIZE; i++)
            table[i] = NULL;
    }

    // Insert or update resident record
    void insert(int residentID, int flatNumber) {
        int hashKey = hashFunction(residentID);
        Node* newNode = new Node(residentID, flatNumber);

        if (table[hashKey] == NULL) {
            table[hashKey] = newNode;
        } else {
            Node* temp = table[hashKey];
            while (temp->next != NULL) {
                if (temp->residentID == residentID) {
                    temp->flatNumber = flatNumber;
                    delete newNode;
                    return;
                }
                temp = temp->next;
            }
            if (temp->residentID == residentID) {
                temp->flatNumber = flatNumber;
                delete newNode;
                return;
            }
            temp->next = newNode;
        }
    }

    // Search resident by ID
    void search(int residentID) {
        int hashKey = hashFunction(residentID);
        Node* temp = table[hashKey];

        while (temp != NULL) {
            if (temp->residentID == residentID) {
                cout << "Resident ID: " << residentID
                     << " | Flat Number: " << temp->flatNumber << endl;
                return;
            }
            temp = temp->next;
        }
        cout << "Resident ID " << residentID << " not found." << endl;
    }

    // Remove resident record
    void remove(int residentID) {
        int hashKey = hashFunction(residentID);
        Node* temp = table[hashKey];
        Node* prev = NULL;

        while (temp != NULL && temp->residentID != residentID) {
            prev = temp;
            temp = temp->next;
        }

        if (temp == NULL) {
            cout << "Resident ID " << residentID << " not found." << endl;
            return;
        }

        if (prev == NULL)
            table[hashKey] = temp->next;
        else
            prev->next = temp->next;

        delete temp;
        cout << "Resident record removed successfully." << endl;
    }
};

int main() {
    ApartmentHashTable hashTable;
    int choice, residentID, flatNumber;

    do {
        cout << "\n1. Add / Update Resident"
             << "\n2. Search Resident"
             << "\n3. Remove Resident"
             << "\n4. Exit"
             << "\nEnter your choice: ";
        cin >> choice;

        switch (choice) {
            case 1:
                cout << "Enter Resident ID: ";
                cin >> residentID;
                cout << "Enter Flat Number: ";
                cin >> flatNumber;
                hashTable.insert(residentID, flatNumber);
                break;

            case 2:
                cout << "Enter Resident ID to search: ";
                cin >> residentID;
                hashTable.search(residentID);
                break;

            case 3:
                cout << "Enter Resident ID to remove: ";
                cin >> residentID;
                hashTable.remove(residentID);
                break;

            case 4:
                cout << "Exiting Apartment Management System..." << endl;
                break;

            default:
                cout << "Invalid choice. Try again." << endl;
        }
    } while (choice != 4);

    return 0;
}
